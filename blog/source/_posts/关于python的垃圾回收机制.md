---
title: 关于python的垃圾回收机制1
date: 2019-08-29 16:59:17
categories: 笔记
tags: python
---

## 关于python 的垃圾回收机制
为什么要了解内存回收机制,平时在写程序的时候因为现在电脑的内存都比较宽裕,所以就没有考虑过垃圾回收这方的知识.但是在服务器中,我们还是知道python 什么时候吧内存释放掉比较好.
python自带的计时器 CPython主要是使用了三种回收机制
- 引用计数
- 标记清除
- 分代回收

<!--more-->

## 引用计数
python 的 垃圾回收主要是已引用为主.引用计数用在记录当前对象被引用的次数也就是查看到底有多少个引用指向了这个对象.当对象被创建或者被引用该对象的引用计数器就会加1,当该对象被销毁(del)或者对象离开了他的作用域,该对象的引用计数器就会减1.当对象的引用计数器为0的时候,对象对应的那一块内存就会被释放.
### 什么时候引用计数器会加1
- 对象被创建
- 对象被引用
- 对象被作为参数传入到函数当中
- 作为一个元素存储在容器当中
### 什么时候会引用计数器会减1
- 对象的别名被显示销毁 (使用del)
- 该对象引用名被赋予新的对象
- 局部变量离开自己的作用域,比如函数执行结束(全局变量不会)
- 元素从容器中删除
在 object.h 中 就有关于python对象的核心代码
```
 typedef struct _object {
    _PyObject_HEAD_EXTRA
    Py_ssize_t ob_refcnt;  // 引用计数值
    struct _typeobject *ob_type;
  } PyObject;
  ```
  在python中想要查询一个对象的 引用计数值可以通过sys.getrefcount()方法查看
  需要注意的是 使用 sys.getrefcount()方法 会使引用计数值加1


  *未完待续.......*
